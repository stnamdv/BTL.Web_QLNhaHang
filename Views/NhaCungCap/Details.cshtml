@model BTL.Web.Models.NhaCungCap

@{
    ViewData["Title"] = "Chi tiết nhà cung cấp";
}

<h1>Chi tiết nhà cung cấp</h1>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Thông tin nhà cung cấp</h5>
            </div>
            <div class="card-body">
                <dl class="row">
                    <dt class="col-sm-4">Tên nhà cung cấp:</dt>
                    <dd class="col-sm-8">
                        <span class="badge bg-info">@Model.ten</span>
                    </dd>

                    <dt class="col-sm-4">Địa chỉ:</dt>
                    <dd class="col-sm-8">@(Model.dia_chi ?? "Chưa cập nhật")</dd>

                    <dt class="col-sm-4">Số điện thoại:</dt>
                    <dd class="col-sm-8">@(Model.sdt ?? "Chưa cập nhật")</dd>
                </dl>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Thống kê</h5>
            </div>
            <div class="card-body">
                @if (ViewBag.Statistics != null)
                {
                        var stats = ViewBag.Statistics;
                        <dl class="row">
                            <dt class="col-sm-6">Số nguyên liệu cung cấp:</dt>
                            <dd class="col-sm-6">
                                <span class="badge bg-primary">@(stats.GetType().GetProperty("so_nguyen_lieu_cung_cap")?.GetValue(stats) ?? 0)</span>
                            </dd>

                            <dt class="col-sm-6">Số lần cung cấp:</dt>
                            <dd class="col-sm-6">
                                <span class="badge bg-success">@(stats.GetType().GetProperty("so_lan_cung_cap")?.GetValue(stats) ?? 0)</span>
                            </dd>

                            <dt class="col-sm-6">Tổng giá trị:</dt>
                            <dd class="col-sm-6">
                                <span class="badge bg-warning">@(((decimal)(stats.GetType().GetProperty("tong_gia_tri")?.GetValue(stats) ?? 0)).ToString("N0")) ₫</span>
                            </dd>
                        </dl>
                }
                else
                {
                        <p class="text-muted">Chưa có thống kê.</p>
                }
            </div>
        </div>
    </div>
</div>

@if (ViewBag.NguyenLieuList != null && ((IEnumerable<BTL.Web.Models.NguyenLieuWithNhaCungCap>)ViewBag.NguyenLieuList).Any())
{
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Danh sách nguyên liệu cung cấp</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Tên nguyên liệu</th>
                                        <th>Đơn vị</th>
                                        <th>Số món sử dụng</th>                                        
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in (IEnumerable<BTL.Web.Models.NguyenLieuWithNhaCungCap>)ViewBag.NguyenLieuList)
                                    {
                                            <tr>
                                                <td><strong>@item.ten</strong></td>
                                                <td>@item.don_vi</td>
                                                <td>
                                                    <span class="badge bg-info">@item.so_mon_su_dung</span>
                                                </td>                                                
                                            </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
}

<div class="mt-3">
    <a asp-action="Edit" asp-route-id="@Model.ncc_id" class="btn btn-warning">Sửa</a>
    <a asp-action="Delete" asp-route-id="@Model.ncc_id" class="btn btn-danger">Xóa</a>
    <a asp-action="Stats" asp-route-id="@Model.ncc_id" class="btn btn-info">Thống kê</a>
    <a asp-action="Index" class="btn btn-secondary">Quay lại</a>
</div>
